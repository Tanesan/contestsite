/*!
 * jQuery Bully Plugin v0.1.3
 * Examples and documentation at http://pixelgrade.github.io/rellax/
 * Copyright (c) 2016 PixelGrade http://www.pixelgrade.com
 * Licensed under MIT http://www.opensource.org/licenses/mit-license.php/
 */
!function($,window,document,undefined){var $window=$(window),windowHeight=$window.height(),elements=[],$bully,lastScrollY=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),current=0,inversed=!1,frameRendered=!0;function reloadAll(){$.each(elements,(function(i,element){element._reloadElement()}))}function staggerClass($elements,classname,timeout){$.each($elements,(function(i,obj){obj.$bullet.addClass(classname)}))}function Bully(element,options){this.element=element,this.options=$.extend({},$.fn.bully.defaults,options);var label="",id=element.id,self=this,$bullet=$('<div id="bully__'+id+'" class="c-bully__bullet">');Onepress_Bully.enable_label&&(id&&void 0!==Onepress_Bully.sections[id]&&(label=Onepress_Bully.sections[id].title),label&&$bullet.append('<div class="c-bully__title">'+label+"</div>")),$bullet.data("bully-data",self).appendTo($bully),$bullet.on("click",(function(event){event.preventDefault(),event.stopPropagation(),self.onClick()})),this.$bullet=$bullet,self._reloadElement(),elements.push(self),current=0}$bully=$('<div class="c-bully">').appendTo("body"),Onepress_Bully.disable_mobile&&$bully.addClass("c-bully-hide-on-mobile"),$current=$('<div class="c-bully__bullet c-bully__bullet--active">').appendTo($bully),function update(){if(!0!==frameRendered){var count=0,lastItemId=!1,_bt=$bully.offset().top,_bh,_bb=$bully.height()+_bt;if($.each(Onepress_Bully.sections,(function(id,arg){var element=$("#"+id);if(element.length){var _et=element.offset().top,_eh,_eb=element.height()+_et;(_et<=_bt||_bb>=_eb||_bb>=_et&&_eb>_bb)&&(lastItemId=id,arg.enable&&(count+=1))}})),lastItemId&&void 0!==Onepress_Bully.sections[lastItemId]&&(Onepress_Bully.sections[lastItemId].inverse?$bully.addClass("c-bully--inversed"):$bully.removeClass("c-bully--inversed")),count!==current){var activeBullet=$bully.find("#bully__"+lastItemId),bullyOffset=$bully.offset(),offset=0;activeBullet.length>0&&(offset=activeBullet.offset().top-bullyOffset.top),$current.removeClass("c-bully__bullet--squash"),setTimeout((function(){$current.addClass("c-bully__bullet--squash")})),$current.css("top",offset),current=count,$bully.find(".c-bully__bullet--pop").removeClass("c-bully__current"),activeBullet.addClass("c-bully__current")}}window.requestAnimationFrame(update),frameRendered=!0}(),$window.on("load",(function(e){staggerClass(elements,"c-bully__bullet--pop",400),frameRendered=!1})),$window.on("scroll",(function(e){!0===frameRendered&&(lastScrollY=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0)),frameRendered=!1})),$window.on("load resize",(function(){reloadAll()})),Bully.prototype={constructor:Bully,_reloadElement:function(){this.offset=$(this.element).offset(),this.height=$(this.element).outerHeight()},_calcTop:function(top){return $("#masthead").hasClass("is-sticky")&&(top-=$("#masthead").outerHeight()),top},onClick:function(){var self=this,$target=$("html, body");if(0!=this.options.scrollDuration)if("auto"!==this.options.scrollDuration)$target.animate({scrollTop:this._calcTop(this.offset.top)},this.options.scrollDuration);else{var duration=Math.abs(lastScrollY-this.offset.top)/(this.options.scrollPerSecond/1e3);$target.animate({scrollTop:this._calcTop(this.offset.top)},duration)}else $target.scrollTop(this._calcTop(this.offset.top))}},$.fn.bully=function(options){return this.each((function(){$.data(this,"plugin_"+Bully)||$.data(this,"plugin_"+Bully,new Bully(this,options))}))},$.fn.bully.defaults={scrollDuration:"auto",scrollPerSecond:4e3,sections:{}},$window.on("rellax load",reloadAll)}(jQuery,window,document),jQuery(document).ready((function($){$.each(Onepress_Bully.sections,(function(id,args){args.enable&&$("#"+id).bully({scrollPerSecond:3e3})}))}));